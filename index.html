<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sketch</title>
  <link rel="stylesheet" type="text/css" href="style.css?t=1760000004000">
  <script src="libraries/p5.min.js?t=1760000004000"></script>
  <script src="libraries/p5.sound.min.js?t=1760000004000"></script>
</head>

<body>
  <div id="debug-panel" style="display: none;">
    <input type="number" id="decay-probability" min="0" max="1" step="0.00001" value="0">
    <label for="decay-probability">Decay Probability</label><br>
    <input type="number" id="collision-probability" min="0" max="1" step="0.001" value="0">
    <label for="collision-probability">Collision Probability</label><br>
    <input type="number" id="neutron-speed" min="1" max="20" step="0.5" value="0">
    <label for="neutron-speed">Neutron Speed</label><br>
    <input type="number" id="controlRodAbsorption" min="0" max="1" step="0.01" value="0">
    <label for="controlRodAbsorption">Control Rod Absorption</label><br>
    <input type="number" id="controlRodHitProbability" min="0" max="1" step="0.01" value="0">
    <label for="controlRodHitProbability">Control Rod Hit Probability</label><br>
    <p id="collisions-per-second">Collisions per Second: 0</p>
    <p id="energy-output">Energy output: 0 kW</p>
    <p id="energy-this-frame">Energy this frame: 0 kW</p>
    <p id="neutron-speed-display">Neutron Speed: 5</p>
  </div>

  <div id="canvas-container" style="position: relative; width: 1067px; height: 600px;">
    <!-- Loading Screen -->
    <div id="loading-screen" style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; background-color: black; color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 20; font-family: Arial, sans-serif;">
      <h1>Loading...</h1>
      <div style="width: 200px; height: 20px; background-color: gray; margin: 20px 0;">
        <div id="loading-bar" style="height: 100%; background-color: green; width: 0%;"></div>
      </div>
      <p id="loading-percentage">0%</p>
      <p id="loading-task">Initializing...</p>
    </div>
    <!-- Single WebGL Canvas for the entire game -->
    <canvas id="gameCanvas" width="1067" height="600"
      style="position: absolute; left: 0; top: 0; z-index: 10;">
    </canvas>

    <!-- UI Overlay Layer -->
    <div id="ui-layer">
      <!-- Sidebar (Permanent UI) -->
      <div id="ui-sidebar">
        <!-- Sidebar content generated by JS -->
      </div>

      <!-- Shop Overlay (Pop-up) -->
      <div id="ui-shop-overlay" class="hidden">
        <div id="ui-shop-content">
          <h2>Shop</h2>
          <div id="shop-amount-controls" style="margin-bottom: 15px; display: flex; gap: 10px; align-items: center;">
             <span>Buy Amount:</span>
             <label><input type="radio" name="buyAmount" value="1" checked> 1</label>
             <label><input type="radio" name="buyAmount" value="5"> 5</label>
             <label><input type="radio" name="buyAmount" value="10"> 10</label>
             <label><input type="radio" name="buyAmount" value="MAX"> MAX</label>
          </div>
          <div id="ui-shop-items"></div>
          <button id="ui-shop-close">Close</button>
        </div>
      </div>

      <!-- Pause Menu Overlay -->
      <div id="ui-pause-menu" class="hidden">
        <h2>Paused</h2>
        <div class="pause-buttons">
          <button id="btn-resume">Resume</button>
          <button id="btn-save">Save Game</button>
          <button id="btn-load">Load Game</button>
          <button id="btn-settings">Settings</button>
        </div>
      </div>
      
      <!-- Save/Load Slot Selection Overlay (initially hidden) -->
      <div id="ui-slot-menu" class="hidden" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); padding: 30px; border: 2px solid white; z-index: 50; color: white;">
          <h2 id="slot-menu-title">Select Slot</h2>
          <div id="slot-buttons" style="display: flex; flex-direction: column; gap: 10px;">
              <!-- Slots generated by JS -->
          </div>
          <button id="btn-slot-cancel" style="margin-top: 20px;">Cancel</button>
      </div>
      
      <!-- Settings Overlay (initially hidden) -->
      <div id="ui-settings-menu" class="hidden" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(20,20,20,0.95); padding: 30px; border: 2px solid #888; z-index: 50; color: white; width: 450px; max-height: 80vh; overflow-y: auto;">
          <h2 id="settings-title" style="text-align: center;">Settings</h2>
          
          <!-- View: Main -->
          <div id="settings-view-main" style="display: flex; flex-direction: column; gap: 10px;">
              <button id="btn-set-audio" style="padding: 10px; cursor: pointer;">Audio Settings</button>
              <button id="btn-set-video" style="padding: 10px; cursor: pointer;">Video Settings</button>
              <button id="btn-settings-close" style="padding: 10px; cursor: pointer; margin-top: 20px;">Back</button>
          </div>

          <!-- View: Audio -->
          <div id="settings-view-audio" class="hidden">
             <div style="display: grid; grid-template-columns: 80px 1fr 30px; gap: 10px; align-items: center; margin-bottom: 20px;">
                 <span>Master</span> <input type="range" id="set-audio-master" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-master">
                 <span>SFX</span> <input type="range" id="set-audio-sfx" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-sfx">
                 <span>Ambience</span> <input type="range" id="set-audio-ambience" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-ambience">
                 <span>Steam</span> <input type="range" id="set-audio-steam" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-steam">
                 <span>Water</span> <input type="range" id="set-audio-water" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-water">
                 <span>Alarms</span> <input type="range" id="set-audio-alarms" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-alarms">
                 <span>Explosions</span> <input type="range" id="set-audio-explosions" min="0" max="1" step="0.01"> <input type="checkbox" id="chk-audio-explosions">
             </div>
             <button id="btn-audio-back" style="padding: 10px; cursor: pointer; width: 100%;">Back</button>
          </div>

          <!-- View: Video -->
          <div id="settings-view-video" class="hidden">
             <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px;">
                 <label><input type="checkbox" id="set-video-bubbles"> Bubbles</label>
                 <label><input type="checkbox" id="set-video-water"> Water Effect</label>
                 <label><input type="checkbox" id="set-video-steam"> Steam</label>
                 <label><input type="checkbox" id="set-video-glow"> Atom Glow</label>
                 <hr style="width: 100%; border-color: #555;">
                 <label>Neutrons</label>
                 <div style="display: flex; align-items: center; gap: 5px;">
                     <input type="range" id="set-video-neutrons" min="0" max="1" step="0.1" style="flex-grow: 1;">
                     <input type="checkbox" id="chk-video-neutrons">
                 </div>
                 <hr style="width: 100%; border-color: #555;">
                 <label>Resolution</label>
                 <button class="res-btn" data-res="0" style="text-align: left; padding: 5px;">1067x600 (Native)</button>
                 <button class="res-btn" data-res="1" style="text-align: left; padding: 5px;">1280x720</button>
                 <button class="res-btn" data-res="2" style="text-align: left; padding: 5px;">1600x900</button>
                 <button class="res-btn" data-res="3" style="text-align: left; padding: 5px;">1920x1080</button>
             </div>
             <button id="btn-video-back" style="padding: 10px; cursor: pointer; width: 100%;">Back</button>
          </div>

      </div>
    </div>
  </div>

  <script src="loader.js?t=1760000004000"></script>
  <script src="audio.js?t=1760000004000"></script>
  <script src="gl.js?t=1760000004000"></script>
  <script src="neutron.js?t=1760000004000"></script>
  <script src="loadingTasks.js?t=1760000004000"></script>
  <script src="sketch.js?t=1760000004000"></script>
  <script src="reportSystem.js?t=1760000004000"></script>
  <script src="sceneHelpers.js?t=1760000004000"></script>
  <script src="grid.js?t=1760000004000"></script>
  <script src="shop.js?t=1760000004000"></script>
  <script src="upgrades.js?t=1760000004000"></script>
  <script src="player.js?t=1760000004000"></script>
  <script src="playerState.js?t=1760000004000"></script>
  <script src="ui.js?t=1760000004000"></script>
  <script src="uiOverlay.js?t=1760000004000"></script>
  <script src="uranium.js?t=1760000004000"></script>
  <script src="controlrod.js?t=1760000004000"></script>
  <script src="water.js?t=1760000004000"></script>
  <script src="meters.js?t=1760000004000"></script>
  <script src="miscFunctions.js?t=1760000004000"></script>
  <script src="shaderFunctions.js?t=1760000004000"></script>
  <script src="atomsRenderer.js?t=1760000004000"></script>
  <script src="steamRenderer.js?t=1760000004000"></script>
  <script src="bubblesRenderer.js?t=1760000004000"></script>
  <script src="waterLayer.js?t=1760000004000"></script>
  <script src="debug.js?t=1760000004000"></script>
  <script src="input.js?t=1760000004000"></script>

</body>

</html>